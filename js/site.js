/** Для проверки email для подписки */function subscribe(){    var form = document.getElementsByClassName('form_subscribe')[0];    var btn = form.getElementsByClassName('formBtn')[0];    var inp = form.querySelectorAll('input[type=text]')[0];    var sp = document.getElementById('err-subscribe');    Event.add(btn,'click',function(e){        e.preventDefault();        if(inp.value.length == 0) {            inp.style.border = '1px solid red';            inp.style.boxShadow = '0 0 8px red';        }        else{            if(validateEmail(inp.value) != true) {                sp.style.display = 'block';                sp.innerHTML = "Введите валидный example@com.ua";            }            if(validateEmail(inp.value) == true){                var m = {};                m['email'] = inp.value;                ajax('/ajax/subscribe', function(d) {                    // sp.innerHTML = "Спасибо, подписка оформленна!"                    // console.log(d);                    // if(d.error == 'duplicate_email') {                    //     sp.style.display = 'block';                    //     sp.innerHTML = "Такой адрес уже есть";                    // }                    // if(!d.error) {                        sp.style.display = 'block';                        sp.innerHTML = "Спасибо, подписка оформленна!";                    // }                }, {}, 'POST', m)            }        }    })}/** Валидация email */function validateEmail(email) {    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;    return re.test(email);}function mainslider(){    var cont = document.getElementsByClassName('mainslider')[0];    Event.add(window,'click',function(e){        var d = new DomPath2(e.target);        var elementClass = d.dompath[0].classes[0];        if(elementClass == 'mainsliderdiv') mainsliderpointFunc(d.dompath[0].dom);        if(elementClass == 'mainslider') mainsliderFunc(d.dompath[0].dom);    });    var mainsliderpointFunc = function(x){        var uri = x.getAttribute('data-uri');        var href = x.getAttribute('data-href');        cont.style.background = 'url("'+uri+'") 50% 0 no-repeat';        cont.style.backgroundSize = 'cover';        cont.setAttribute('href','/item/'+href);    };    var mainsliderFunc = function(x){        window.location.href = x.getAttribute('href');    };}function ajaxForm(){    var form = document.getElementsByClassName('ajaxForm')[0];    var submit = form.querySelectorAll('button')[0];    var name = form.querySelectorAll('input[type=text]')[0];    var text = form.querySelectorAll('textarea')[0];    var email = form.querySelectorAll('input[type=email]')[1];    var sp = document.getElementsByClassName('questionDiv')[0];    Event.add(submit,'click',function(e){        e.preventDefault();        if(name.value.length == 0) {            name.style.border = '1px solid red';            name.style.boxShadow = '0 0 5px red';        }else{            var m = {};            m.name = name.value;            if(text) m.text = text.value;            m.urn = form.getAttribute('data-urn');            m.type = form.getAttribute('data-type');            m.which = form.getAttribute('data-which');            var send = true;            if(email){                send = false;                if(validateEmail(email.value) != true) {                    sp.innerHTML = "Введите валидный email";                    email.style.border = '1px solid red';                    email.style.boxShadow = '0 0 5px red';                }                if(validateEmail(email.value) == true){                    sp.innerHTML = "";                    email.style.border = '1px solid transparent';                    email.style.boxShadow = '0';                    name.style.border = '1px solid transparent';                    name.style.boxShadow = '0';                    m.email = email.value;                    send = true;                }            }            if(send == true){                ajax('/ajax/comment', function(d) {                    toast('Спасибо!<br> Администратор свяжется с вами в кротчайшие сроки');                    name.value = '';                    email.value = '';                    text.value = '';                    // setTimeout(function(){window.location.reload();},4000);                }, {}, 'POST', m)            }        }    });}function leaveComment() {    var form = document.getElementsByClassName('ajaxForm')[0];    var submit = form.getElementsByClassName("commentButton")[0];    var name = form.getElementsByClassName("commentName")[0];    var text = form.getElementsByClassName("commentComment")[0];    var email = form.getElementsByClassName("commentEmail")[0];    var sp = document.getElementsByClassName('errorMsg')[0];    function checkL(element) {        if (element.value.length === 0) {            element.style.border = '1px solid red';            element.style.boxShadow = '0 0 5px red';            return false;        } else {            element.style.border = '1px solid #cccccc';            element.style.boxShadow = 'none';            return true;        }    }    Event.add(submit, 'click', function (e) {        e.preventDefault();        checkL(name);        checkL(email);        checkL(text);        if (checkL(name) && checkL(email) && checkL(text) ) {            if (validateEmail(email.value) != true) {                sp.innerHTML = "Введите валидный email";                email.style.border = '1px solid red';                email.style.boxShadow = '0 0 5px red';                return false;            } else {                email.style.border = '1px solid #cccccc';                email.style.boxShadow = 'none';            }            var m = {};            m.name = name.value;            m.text = text.value;            m.email = email.value;            ajax('/ajax/review', function (d) {                toast('Спасибо!<br> Ваше сообщение будет опубликовано после модерации');                name.value = '';                email.value = '';                text.value = '';            }, {}, 'POST', m)        }    });}function toast(x){    var toast = document.getElementsByClassName('toast')[0];    toast.style.display = 'block';    toast.querySelectorAll('span')[0].innerHTML = x;    setTimeout(function(){ toast.style.opacity = '1'},1000);    setTimeout(function(){        toast.style.opacity = '0';        setTimeout(function(){ toast.style.display = 'none'},1000)    },6000)}function slider(){    var smallPhoto = document.getElementsByClassName('smallPhoto');    var bigPhoto = document.getElementsByClassName('bigPhoto');    for(var i=0;i<smallPhoto.length;i++){        Event.add(smallPhoto[i],'click',function(){            var src = this.querySelectorAll('img')[0].src;            for(var q=0;q<bigPhoto.length;q++){                var bsrc = bigPhoto[q].querySelectorAll('img')[0].src;                bigPhoto[q].style.opacity = 0;                if(bsrc == src ) bigPhoto[q].style.opacity = 1;            }        });        Event.add(bigPhoto[i],'click',function(){            for(var z=0;z<bigPhoto.length;z++){                if(bigPhoto[z].style.opacity == 1) {                    bigPhoto[z].style.opacity = 0;                    if(z == 0) bigPhoto[bigPhoto.length-1].style.opacity = 1;                    else bigPhoto[z-1].style.opacity = 1;                }            }        })    }}function infinitySliderWithImgs(){    var bod = document.getElementsByClassName('bod')[0];    var down = document.getElementsByClassName('down')[0];    var up = document.getElementsByClassName('up')[0];    var int = bod.querySelectorAll('div');    var alt = int[0].querySelectorAll('img')[0].getAttribute('alt');    var imgs = []; var imgsR = [];    for(var q=0;q<int.length;q++) imgs.push(int[q].querySelectorAll('img')[0].src)    for(var q=int.length;q>0;q--) imgsR.push(int[q-1].querySelectorAll('img')[0].src)    function forward(){        var bigPhoto = document.getElementsByClassName('bigPhoto');        for(var z=0;z<bigPhoto.length;z++){            if(bigPhoto[z].style.opacity == 1) {                bigPhoto[z].style.opacity = 0;                if(z == 0) bigPhoto[bigPhoto.length-1].style.opacity = 1;                else bigPhoto[z-1].style.opacity = 1;            }        }    }    function back(){        var bigPhoto = document.getElementsByClassName('bigPhoto');        for(var z=bigPhoto.length-1;z>=0;z--){            if(bigPhoto[z].style.opacity == 1) {                bigPhoto[z].style.opacity = 0;                if(z == bigPhoto.length-1){                    bigPhoto[0].style.opacity = 1;                } else {                    bigPhoto[z+1].style.opacity = 1;                }            }        }    }    var i = 0;    Event.add(down,'click',function(){        var int = bod.querySelectorAll('div');        if(i==-int.length)i=0;        i--;        var a = i * (-1) - 1;        var newDiv = document.createElement('div');        newDiv.innerHTML = "<img src='"+imgsR[a]+"' alt='"+alt+"' style='height=0'>";        newDiv.style.height = '0';        newDiv.setAttribute('class','animated smallPhoto');        bod.insertBefore(newDiv, bod.querySelectorAll('div')[0]);        setTimeout(function(){            newDiv.style.height = '120px';            newDiv.setAttribute('class','animated int smallPhoto');            int[int.length-1].parentNode.removeChild(int[int.length-1]);            new slider();            new back();        },300);    });    var j = 0;    Event.add(up,'click',function(){        var int = bod.querySelectorAll('div');        if(j==int.length)j=0;        j++;        int[0].style.height = 0;        setTimeout(function(){            int[0].parentNode.removeChild(int[0]);            var newDiv = document.createElement('div');            newDiv.innerHTML = "<img src='"+imgs[j-1]+"' alt='"+alt+"' style='height=0'>";            newDiv.style.height = '0';            newDiv.setAttribute('class','animated');            bod.appendChild(newDiv);            newDiv.style.height = '120px';            newDiv.setAttribute('class','animated int smallPhoto');            new slider();            new forward();        },300);    });}function countview(){    var gcurni = document.getElementById('urn').value;    ajax('/ajax/countview', function(d) {}, {}, 'POST', {'urn':gcurni});}function sliderHorizontal(){    var sliderHorizontal = document.getElementsByClassName('sliderHorizontal');    for (var i = 0; i < sliderHorizontal.length; i++) {        var obj = sliderHorizontal[i];        var frame = obj.getElementsByClassName('sliderFrame')[0];        var content = obj.getElementsByClassName('sliderContent')[0];        var arr = obj.getElementsByClassName('sliderArr');        var maxSteps = 2;        var frameWidth = parseInt(frame.offsetWidth);        Event.add(arr[0], 'click', move.bind({'content': content, 'arr': arr[0]})); // move left        Event.add(arr[1], 'click', move.bind({'content': content, 'arr': arr[1]})); // move right    }    function move(){        var way = this.arr.getAttribute('data-move');        var leftValue = parseInt(getComputedStyle(this.content, null).getPropertyValue('left'));        leftValue = way == 'left' ? leftValue + frameWidth : leftValue - frameWidth;        if(leftValue == frameWidth && way == 'left' || leftValue == maxSteps * frameWidth * (-1) && way == 'right') return;        this.content.style.left = leftValue + 'px';    }}function changeBigPhoto() {    var bigPhoto = document.getElementsByClassName('bigPhotoMain')[0];    var src = ['/img/main/12.jpg', '/img/main/13.jpg', '/img/main/11.jpg'];    var i = 0;    setInterval(function(){        bigPhoto.style.opacity = 0;        setTimeout(function() {            bigPhoto.src = src[i];            bigPhoto.style.opacity = 1;            i++;            if(i == 3) i = 0;        }, 350);    }, 5000);}